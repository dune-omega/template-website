/*! Colliers - helix.min.js - 2/23/2023, 11:04:50 PM */

var COLLIERS=COLLIERS||{};COLLIERS.Communications=function(r){return{init:function(){r(document).on("click","#saveCommunicationsOptOut",function(){var e=r("#communicationsForm").serializeArray(),t=COLLIERS.Helix.getCSRFTokenHeader(r(this));COLLIERS.Ajax.postDataWithHeaders(t,"/marketing-communications/save-communications-optout",function(){r("#consentAccepted").attr("hidden",!0),r("#consentNotAccepted #MarketingConsent").prop("checked",!1),r("#consentNotAccepted").removeAttr("hidden"),r("#optOut").modal("show")},function(){r("#communicationsOptOutError").removeAttr("hidden")},e)}),r(document).on("click","#saveCommunicationsConsent",function(){var e=r("#communicationsForm").serializeArray(),t=COLLIERS.Helix.getCSRFTokenHeader(r(this));COLLIERS.Ajax.postDataWithHeaders(t,"/marketing-communications/save-communications-consent",function(e){e.Message&&COLLIERS.Helix&&COLLIERS.Helix.convertUTCDate&&(e=e.Message.replace(e.Token1,COLLIERS.Helix.convertUTCDate(e.UtcDateTime1,e.DateFormat)),r("#consentAccepted #marketingConsentDateMessage").text(e),r("#consentAccepted").removeAttr("hidden"),r("#consentNotAccepted").attr("hidden",!0))},function(){r("#communicationsSaveConsentError").removeAttr("hidden")},e)}),r(document).on("click","#subscriptionUnsubscribe",function(){var e=COLLIERS.Helix.getCSRFTokenHeader(r(this));COLLIERS.Ajax.postDataWithHeaders(e,"/marketing-communications/unsubscribe",function(){r("#consentAccepted").attr("hidden",!0),r("#consentNotAccepted #MarketingConsent").prop("checked",!1),r("#consentNotAccepted").removeAttr("hidden"),r("#subscriptionsPanel").attr("hidden",!0),r("#unsubscribePanel").attr("hidden",!0),r("#noSubscriptionsPanel").removeAttr("hidden"),r("#unsubscribeAll").modal("show")},function(){r("#unsubscribeAllError").removeAttr("hidden")})})}}}(jQuery);var Coveo=Coveo||{};(COLLIERS=COLLIERS||{}).Helix=function(i){function e(e,n,a,o){i(document).on("click",e,function(){var e=i(this).attr("id"),t=n+e,r=COLLIERS.Helix.getCSRFTokenHeader(i(this));COLLIERS.Ajax.postDataWithHeaders(r,t,function(){i(a+e).modal("hide"),i(o+e).remove()},function(){i("#removeServerError-"+e).removeAttr("hidden")})})}return{init:function(){e(".remove-secure-access","/property-documents/secure-documents-remove?propertyGuid=","#remove-secure-access-","#secureDocument-"),e(".remove-research-document","/research/remove-document?researchGuid=","#remove-research-document-","#research-card-"),i(document).on("slid.bs.carousel",function(e){var t=i(e.target),r=i(t.find("ul.pagination li:first")),e=i(t.find("ul.pagination li:last"));t.find(".carousel-inner .carousel-item:first").hasClass("active")?(r.hide(),e.show()):t.find(".carousel-inner .carousel-item:last").hasClass("active")?(e.hide(),r.show()):t.find("ul.pagination li").show()})},convertUTCDate:function(e,t){if(Coveo.DateUtils){t={predefinedFormat:t};return e=e.replace(" ","T"),Coveo.DateUtils.dateToString(Coveo.DateUtils.convertFromJsonDateIfNeeded(e),t)}return e},getCSRFTokenHeader:function(e){var t=null;return!e||(e=i("input[name='__RequestVerificationToken']",e).val())&&(t={"X-RequestVerificationToken":e}),t}}}(jQuery),(COLLIERS=COLLIERS||{}).Modals=function(r){return{init:function(){var e,t;e=r(".modal.hoist-modal"),t=r("body"),e.remove(),t.append(e),r(".selectAuthTypeFromCreate").each(function(e){var t=r(this).attr("id");r(this).attr("id",t+"-"+e)}),r(document).on("click",".selectAuthTypeFromCreate",function(e){r("#createAccount").modal("hide"),e.preventDefault()})}}}(jQuery),(COLLIERS=COLLIERS||{}).Ajax=function(n){function u(e,t,r,n,a,o,i,s,c,d,l,u){this.type=e,this.url=t,this.data=r,this.success=n,this.error=a,this.errorContainer=o,this.complete=i,this.dataType=s,this.noLoader=c,this.keepLoaderOnComplete=d,this.defaultErrorMessage=l,this.headers=u}function p(t){t.defaultErrorMessage||(t.defaultErrorMessage="An error occurred"),t.errorContainer&&t.errorContainer.find('[data-toggle="err"]').hide().find('[data-fv-for="ajaxCall"]').attr("data-fv-result","VALID"),t.noLoader||e();n.ajax({type:t.type,url:t.url,data:t.data,dataType:t.dataType,success:function(e){t.success&&t.success(e),e.IsSuccessful||(t.errorContainer&&r(t.errorContainer,e.FormattedMessages||t.defaultErrorMessage),t.keepLoaderOnComplete=!1)},error:function(e){t.error&&t.error(e),t.errorContainer&&r(t.errorContainer,e.message||e.statusText||t.defaultErrorMessage),t.keepLoaderOnComplete=!1},complete:function(e){t.complete&&t.complete(e),t.noLoader||t.keepLoaderOnComplete||a()},headers:t.headers})}function r(e,t){var r=n(e);r.find('[data-toggle="err"]').length||r.append('<div data-toggle="err"><div class="alert alert-danger" data-fv-for="ajaxCall" data-fv-result="NOT_VALIDATED" role="alert"></div></div>'),n(e).find('[data-toggle="err"]').show(),n(e).find('[data-fv-for="ajaxCall"]').html(t).attr("data-fv-result","INVALID")}function e(){n("body").prepend('<div class="loader-container"><div class="loader" role="alert" aria-label="Loading"><div class="fa-3x"><i aria-hidden="true" class="fas fa-spinner fa-spin"></i></div></div></div>')}function a(){n(".loader-container").remove()}return{addLoader:e,removeLoader:a,postData:function(e,t,r,n,a,o,i,s,c,d){p(new u("POST",e,n,t,r,a,o,i,s,c,d))},getData:function(e,t,r,n,a,o,i,s,c,d){p(new u("GET",e,n,t,r,a,o,i,s,c,d))},postDataWithHeaders:function(e,t,r,n,a,o,i,s,c,d,l){p(new u("POST",t,a,r,n,o,i,s,c,d,l,e))}}}(jQuery),(COLLIERS=COLLIERS||{}).Register=function(o){var r="#portalRegister",n="#portalRegisterExit",a=!0,i="";function s(){return i}function c(e){o(e).each(function(){var e=o(this),t=e.find('input[type="checkbox"]');e.hasClass("card-other")?e.attr("role","button"):(e.attr("role","checkbox"),t.prop("checked")?e.attr("aria-pressed","true"):e.attr("aria-pressed","false"))}),o(document).on("keydown click",e,function(e){var t,r=o(this),n=r.find('input[type="checkbox"]'),a=n.prop("checked");13!==(t=e).which&&"click"!==t.type||(r.hasClass("card-other")?(e.preventDefault(),t=r.find(".starting-text"),e=r.find(".card-input-other"),t.hide(),e.show(),o("#careerOther").focus()):(n.prop("checked",!a),r.toggleClass("selected",!a).attr("aria-pressed",!a),n.next("i").toggleClass("fa-check-circle",!a)))})}function d(e){o(document).on("blur",e,function(){var e,t=o(this).parents("div.card"),r=t.find('input[type="checkbox"]');""===o("#careerOther").val()?(o("card-other").removeClass("selected"),e=t.find(".starting-text"),t.find(".card-input-other").hide(),e.show(),r.prop("checked",!1),t.removeClass("selected"),r.next("i").removeClass("fa-check-circle")):(r.prop("checked",!0),t.addClass("selected"),r.next("i").addClass("fa-check-circle"))})}function l(){var e,t=o("#careerOther"),r=t.parents("div.card"),n=r.find('input[type="checkbox"]');t.val()&&(e=r.find(".starting-text"),t=r.find(".card-input-other"),e.hide(),t.show(),n.prop("checked",!0),r.addClass("selected"),n.next("i").addClass("fa-check-circle"))}function u(){o("#restrictError").hide()}function p(){var e=o("#registerUserForm").serializeArray();COLLIERS.Ajax.postData("registration/updatecookie",null,null,e,null,null,null,!0)}function f(e){setTimeout(function(){o(e).find('input[type="text"], select').each(function(){var e=o(this).attr("required"),t=o(this).data("msg-required");void 0!==e&&!1!==e&&o(this).prev().append('<span class="form-required" aria-label="'+t+'"> *</span>')})},500)}return o.validator.addMethod("isValidGuid",function(e){return"00000000-0000-0000-0000-000000000000"!==e}),f("#portalUserForm"),{init:function(){var e,t;window.location.search.indexOf("register=popup")<0||(window.addEventListener("beforeunload",function(){p()}),0!==(e=o("#loadPortalModal")).length&&((i=e.data("exitPrompt"))&&window.addEventListener("beforeunload",s),COLLIERS.Ajax.getData("/registration/register",function(e){o("#body-wrapper").append(e),o(r).modal("show"),o("#registerUserForm > .tab-content > .tab-pane:last").find(".regNext").text("Finish").removeClass("regNext").attr("type","submit"),o("#registerUserForm").validate({rules:{IsBusinessConsentGiven:{required:!0,minlength:1},IsLegalConsentGiven:{required:!0,minlength:1}},errorPlacement:function(e,t){var r=t.attr("name");"IsBusinessConsentGiven"===r||"IsLegalConsentGiven"===r?e.addClass("text-left").insertAfter(t.parent("div")):e.insertAfter(t)}}),o("#registerUserForm").bind("change keyup",function(){var e=o("#portalRegister .regNext");!o(this).validate().checkForm()||o("#UserData_Country").hasClass("js-isRestricted")?e.attr("disabled","disabled"):e.removeAttr("disabled")}),l(),u(),f("#registerUserForm"),"undefined"!=typeof tokenfieldComponent&&tokenfieldComponent.init()}),o(document).on("hide.bs.modal",r,function(){a&&(p(),o(n).modal("show"))}),o(document).on("click",n+" .continue-register",function(){o(n).modal("hide"),o(r).modal("show")}),o(document).on("click",n+" .remove-account",function(){o(n).modal("hide")})),o(document).on("click","#portalRegister .regNext",function(){var e=o("#portalRegister .regNext");o("#registerUserForm").valid()?o("#nav-tabs > .nav-item > .active").parent().next("li").find("a").trigger("click"):e.attr("disabled","disabled")}),o(document).on("show.bs.tab","#nav-tabs > .nav-item > a",function(e){o("#registerUserForm").valid()||e.preventDefault()}),o(document).on("shown.bs.tab","#nav-tabs > .nav-item > a",function(){var e=o("#nav-tabs > .nav-item > .active");o("#nav-tabs > .nav-item").removeClass("open"),e.parent().prevAll("li").find(".js-current-step").addClass("d-none"),e.parent().prevAll("li").find(".js-completed-step").removeClass("d-none"),e.parent().nextAll("li").find(".sr-only").addClass("d-none"),e.parent().addClass("open"),e.parent().find(".js-current-step").removeClass("d-none"),e.parent().find(".js-completed-step").addClass("d-none")}),o(document).on("click","#portalRegister .regPrevious",function(){o("#nav-tabs > .nav-item > .active").parent().prev("li").find("a").trigger("click")}),o(document).on("submit","#registerUserForm",function(e){var t=o(this).serializeArray();COLLIERS.Ajax.postData("/registration/submit",function(e){i&&window.removeEventListener("beforeunload",s),"True"!==o("#UserData_FauxUser").val()?(o("#nav-tabs").remove(),a=!1,o("#portalRegister").modal("hide"),window.location=e.AutoRedirectUrl):window.location.href="/"},function(){o("#formErrorMessage").show()},t),e.preventDefault()}),o(document).on("change keyup","#UserData_Country",function(){var t=o("#portalRegister .regNext"),r=o("#UserData_Country"),e=o(this).val();if(o("#UserData_Country-error").hide(),"00000000-0000-0000-0000-000000000000"===e)return u(),void r.removeClass("js-isRestricted");o("#UserData_Country-error").hide();COLLIERS.Ajax.getData("/portaluser/iscountryrestricted?countryId="+e,function(e){e?(o("#restrictError").show(),r.addClass("js-isRestricted"),t.attr("disabled","disabled")):(r.removeClass("js-isRestricted"),o("#registerUserForm").validate().checkForm()?t.removeAttr("disabled"):t.attr("disabled","disabled"),u())},null,null,null,null,null,!0)}),t=o("#CybotCookiebotDialog"),o(document).on("ready",function(){"block"===t.css("display")&&o(r).addClass("cookies-present")}),c("#portalRegister .card"),d("#portalRegister #careerOther"))},checkOtherCareerInput:l,bindOtherFocusOff:d,bindCardClick:c}}(jQuery);Coveo=Coveo||{};(COLLIERS=COLLIERS||{}).MyProfile=function(s){function o(e,t,r,n){var a="/portalendpoint/";a+=t?"savepropertyfavorite":"removepropertyfavorite";var o={itemId:r},i=COLLIERS.Helix.getCSRFTokenHeader(e.closest(".teaser-card-container, .property-details__hero"));COLLIERS.Ajax.postDataWithHeaders(i,a,function(){if(e.toggleClass(n),!t&&s("#removeFavoriteModal").length&&(s("#removeFavoriteModal").modal("hide"),s("#portalProfile").length))return s("[data-property-id='"+r+"']").closest(".CoveoResult").fadeOut(),!1},null,o)}function e(e){"00000000-0000-0000-0000-000000000000"!==e&&(s('#portalUserForm :input:not([name="UserData.Country"])').attr("disabled","disabled"),s("#saveCoreProfile").attr("disabled","disabled"),COLLIERS.Ajax.getData("/portaluser/iscountryrestricted?countryId="+e,function(e){e?s("#restrictError").show():(s('#portalUserForm :input:not([name="UserData.Country"])').removeAttr("disabled"),s("#restrictError").hide(),s("#saveCoreProfile").removeAttr("disabled"))},null,null,null,null,null,!0))}function t(){s("#get-favorite-properties").length&&s.ajax({type:"GET",url:"/portalendpoint/getfavoriteproperties",dataType:"json",success:function(e){COLLIERS.MyProfile.favoriteProperties=e.Favorites;e=s(".favorite-icon__container").data("propertyId");s(".favorite-icon__container").length&&0<=COLLIERS.MyProfile.favoriteProperties.indexOf(e)&&s(".favorite-icon__container").addClass("selected"),s(".teaser-card-container .favorite-icon").each(function(){var e=s(this).data("propertyId");0<=COLLIERS.MyProfile.favoriteProperties.indexOf(e)&&s(this).data("propertyId",e).addClass("favorite-icon-selected")})}})}function r(){var e;"undefined"!==Coveo&&(Coveo.SearchEndpoint.configureSampleEndpointV2(),null!==(e=document.querySelector("#propertysearch"))&&(s(window).on("popstate",function(){t()}),s(e).on("newResultsDisplayed",function(){COLLIERS.MyProfile.favoriteProperties.length<1||t()})))}function n(){var e=document.querySelectorAll('a[href*="keystoneaccess"]');Array.from(e).forEach(function(e){e.addEventListener("click",function(e){var t,r,n,a;(null!==window.location.search&&0<window.location.search.length||null!==window.location.hash&&0<window.location.hash.length)&&(e.preventDefault(),r=this.href,t=window.location.href,n=this.href,a=t,0<=n.toLowerCase().indexOf("#fp=")&&((e=n.replace(/.*#fp(=|%3d)([^&]*).*/gim,"$2"))&&(n=0<=a.indexOf("#"),a+=(n?"&":"#")+"fp="+e.trim())),t=a,r=(r=r.replace(/KeystoneInvokeUrl=[^&]*(&?)/gm,"KeystoneInvokeUrl="+encodeURIComponent(t)+"$1")).replace(/KeystoneClientCallBackURL=[^&]*(&?)/gm,"KeystoneClientCallBackURL="+encodeURIComponent(t)+"$1"),window.location.href=r)})})}return{init:function(){s(document).on("click",".favorite-login-required",function(e){var n=s(this).data("property-id");n&&s("a.login-link").each(function(e,t){var r=s(t),t=(t=r.attr("href")).replace(/KeystoneClientCallBackURL(=|%3d)(.*?)(&.*)/gim,"KeystoneClientCallBackURL$1$2#fp="+n+"$3");r.attr("href",t)}),s("#createAccount").modal("show"),e.preventDefault()}),s(document).on("click",".favorite-icon-click",function(e){var t=s(this),r=t.data("propertyId"),n=t.hasClass("favorite-icon__container")?"selected":"favorite-icon-selected",a=!0;if(t.hasClass(n)){if(s("#removeFavoriteModal").length)return s("#removeFavorite").data("propertyid-remove",r),s("#removeFavoriteModal").modal("show"),void e.preventDefault();a=!1}o(t,a,r,n)}),s(document).on("keydown click",".mobile-header",function(e){13!==(e=e).which&&32!==e.which&&"click"!==e.type||(s(".profile-nav").slideToggle(),s(this).toggleClass("open"),s(this).hasClass("open")?s(this).attr("aria-expanded","true"):s(this).attr("aria-expanded","false"))}),s(document).on("click","#savePreferences",function(){var e,t;s("#preferencesForm").valid()&&(s("#savePreferences").attr("disabled","disabled"),e=s("#preferencesForm").serializeArray(),t=COLLIERS.Helix.getCSRFTokenHeader(s(this)),COLLIERS.Ajax.postDataWithHeaders(t,"/portaluser/preferencessave",function(e){s("#preferencesResponse").text(e.Message)},function(e){s("#preferencesResponse").text(e.statusText)},e,null,function(){s("#preferencesResponse").removeAttr("hidden"),s("#savePreferences").removeAttr("disabled")}))}),s(document).on("click","#saveCoreProfile",function(){var e,t;s("#portalUserForm").valid()&&(s("#saveCoreProfile").attr("disabled","disabled"),e=s("#portalUserForm").serializeArray(),t=COLLIERS.Helix.getCSRFTokenHeader(s(this)),COLLIERS.Ajax.postDataWithHeaders(t,"/portaluser/coreprofilesave",function(e){var t;e.Message&&COLLIERS.Helix&&COLLIERS.Helix.convertUTCDate&&(t=(t=e.Message.replace(e.Token1,COLLIERS.Helix.convertUTCDate(e.UtcDateTime1,e.DateFormat))).replace(e.Token2,COLLIERS.Helix.convertUTCDate(e.UtcDateTime2,e.DateFormat)),s("#accountDatesMessage").text(t),s("#editProfileError").attr("hidden","true"))},function(){s("#editProfileError").removeAttr("hidden")},e,null,function(){s("#saveCoreProfile").removeAttr("disabled")}))}),s(document).on("click","#removeAccount",function(){var e=COLLIERS.Helix.getCSRFTokenHeader(s(this));COLLIERS.Ajax.postDataWithHeaders(e,"/portaluser/removeaccount",function(){s("#removeAccountError").attr("hidden",!0),window.location.href="/navigation/logout"},function(){s("#removeAccountError").removeAttr("hidden")})}),s(document).on("click","#removeFavorite",function(){var e=s(this).data("propertyid-remove");o(s('[data-property-id="'+e+'"]'),!1,e)}),s(document).on("change","#portalUserForm #UserData_Country",function(){e(s(this).val())}),s(document).on("change","#TermsAccepted",function(){s(this).is(":checked")&&s("#saveCountryChange").removeAttr("disabled")}),s(document).on("tokenfield:createdtoken","#marketsTypeAhead",function(e){var t=s("#marketsSelected"),r=s("#marketValueSelector").val(),n=[];t.append("<input name="+r+' type="hidden" value="{'+e.attrs.value.toUpperCase()+'}" />'),t.find('input[name="'+r+'"]').each(function(){0<=n.indexOf(this.value)?s(this).remove():n.push(this.value)})}),s(document).on("tokenfield:removedtoken","#marketsTypeAhead",function(e){s('#marketsSelected input[value="{'+e.attrs.value.toUpperCase()+'}"]').remove()}),s(document).on("tokenfield:edittoken","#marketsTypeAhead",function(){return!1}),0!==s("#portalUserForm").length&&e(s("#UserData_Country").val()),COLLIERS.Register.bindOtherFocusOff("#preferencesForm #careerOther",!1),COLLIERS.Register.bindCardClick("#preferencesForm .card",!1),COLLIERS.Register.checkOtherCareerInput(),window.addEventListener("DOMContentLoaded",r),window.addEventListener("DOMContentLoaded",t),window.addEventListener("DOMContentLoaded",n)},favoriteProperties:[]}}(jQuery),(COLLIERS=COLLIERS||{}).Research=function(t){return{init:function(){!function(){{var e;window.location.hash&&0<=window.location.hash.toLowerCase().indexOf("autodownload=true")&&(e=t(".article-download"),function(){var e=window.location.hash;e=e&&e.replace(/&?autodownload(=|%3d)(false|true)/gim,"");window.location.hash=e}(),e.length&&e[0].click())}}()}}}(jQuery),(COLLIERS=COLLIERS||{}).SecureDocs=function(o){function e(){var r,n=o("#secureDocs");n.hasClass("js-secure-icon-click")&&(n.find("i").removeClass("fa-lock").addClass("fa-spinner fa-spin"),r=n.data("propertyid"),COLLIERS.Ajax.getData("/property-documents/get-secure-documents?propertyId="+r,function(e){o("#body-wrapper").append(e);var t="#secure-"+r,e=o(t).find(".modal-doc__list").length?"fa-lock-open":"fa-lock";n.attr("data-toggle","modal"),n.attr("data-target",t),n.find("i").removeClass("fa-spinner fa-spin").addClass(e),window.analytics.addTrackingToClickEvent&&(window.analytics.addTrackingToClickEvent(o(".modal-doc__item__link")),window.analytics.addTrackingToClickEvent(o(".download__btn"))),e=n,window.location.hash&&0<=window.location.hash.toLowerCase().indexOf("sdad=true")&&(null===(e=e)&&(e=o("#secureDocs")),a(),e&&e.length&&e[0].click())},function(){n.parent().hide()},null,null,null,null,!0))}function a(){var e=window.location.hash;e&&(e=e.replace(/&?(gdad|sdad)(=|%3d)(false|true)/gim,""),window.location.hash=e)}function t(){var e;window.location.hash&&0<=window.location.hash.toLowerCase().indexOf("gdad=true")&&(e=o(".js-gated-documents"),a(),e&&e.length&&e[0].click())}return{init:function(){o("body").one("show.bs.modal",".secure-doc-modal",function(){o("#ndaAgreementForm").validate({submitHandler:function(e){var t=o(e).closest(".modal-body").find(".property-id").val(),r="/property-documents/secure-documents-authorization?propertyId="+t,e=COLLIERS.Helix.getCSRFTokenHeader(o(e));return COLLIERS.Ajax.postDataWithHeaders(e,r,function(e){o("#secure-"+t+" .modal-body .container").html(e)},function(){o("#ndaServerError").removeAttr("hidden")}),!1}})}),o(document).on("click",".js-secure-login-required",function(e){var n,a,t=o(this),r=t.parent().hasClass("view-documents"),t="secureDocs"===t.attr("id");n="gdad%3d"+(r?"True":"False"),a="sdad%3d"+(t?"True":"False"),o(".login-link").each(function(e,t){var r=o(t),t=(t=r.attr("href")).replace(/gdad(=|%3d)(false|true)/gim,n).replace(/sdad(=|%3d)(false|true)/gim,a);r.attr("href",t)}),o("#createAccount").modal("show"),e.preventDefault()}),o(document).on("click",".revoke-confirm",function(){var e=o(this).attr("id").split("-"),t=e[1],r=e[2],e="/property-documents/secure-documents-revoke?userId="+t+"&countryGuid="+r+"&propertyGuid="+o("#PropertyId").val(),n=t+"-"+r,r=COLLIERS.Helix.getCSRFTokenHeader(o(this));COLLIERS.Ajax.postDataWithHeaders(r,e,function(){o("#revoke-modal-"+n).modal("hide"),o("#"+n).remove()},function(){o("#revokeServerError"+n).removeAttr("hidden")})}),window.addEventListener("load",e),window.addEventListener("load",t)}}}(jQuery),(COLLIERS=COLLIERS||{}).Subscriptions=function(p){function t(e,a){p(document).off("click",e),p(document).on("click",e,function(){var e,t,r,n;p("#saveSubscriptionForm").valid()&&(r=COLLIERS.Subscriptions.QueryEventData.queryBuilder.build(),e=COLLIERS.Subscriptions.QueryStringArguments.split("?")[1],t=p("#saveSearchName").val(),n=(n=/@source==["'](.*?)["']/g.exec(r.cq))&&1<n.length?n[1]:"",r=[{name:"subscriptionName",value:t},{name:"url",value:encodeURIComponent(window.location.hash)},{name:"type",value:a},{name:"queryStringArguments",value:e},{name:"keywords",value:r.q},{name:"facets",value:r.aq},{name:"indexSourceName",value:n}],p("#savePropertySearch").modal("hide"),n=COLLIERS.Helix.getCSRFTokenHeader(p("#saveSubscriptionForm")),COLLIERS.Ajax.postDataWithHeaders(n,"/subscription/save-subscription",function(){p(".subscribe-saved").show().fadeOut(5e3)},null,r))})}function e(e,n){p(document).on("click",e,function(){var e=p(this).data("target");v(null,a(p("#location .coveo-selected")).split(">").pop(),a(p('div[data-title="Property type"] .coveo-selected')),1),f(n),p(e).modal("show");var t=p(".save-search-modal__search-parameters__label"),r=m().q;p(e+" .CoveoBreadcrumb").remove(),p(".CoveoBreadcrumb").clone().wrap('<div class="pills" />').insertAfter(t),r&&p(e+" .CoveoBreadcrumb").prepend('<div class="coveo-facet-breadcrumb-value">'+r+"</div>")})}function f(e){p("#saveSearch").addClass(e),t(".properties-subscribe",0),t(".news-subscribe",1),t(".research-subscribe",2)}function v(e,t,r,n){p("#saveSearchName").val("");var a="";0===n?e&&t?(a=e+" - "+t,p("#saveSearchName").val(a)):e?(a=e,p("#saveSearchName").val(a)):t&&(a=t,p("#saveSearchName").val(a)):1===n&&(t&&r?(a=t+" - "+r,p("#saveSearchName").val(a)):r?(a=r,p("#saveSearchName").val(a)):t&&(a=t,p("#saveSearchName").val(a)))}function a(e){var r="";return e.each(function(e){var t=p(this).attr("data-value");r+=0===e?t:", "+t}),r}function r(e,l,u){p(document).on("click",e,function(){var e,t,r,n=p(this).data("target"),a=p("#listingtype .coveo-facet-header-title").attr("title"),o="",i="",s=["sort","advancedSearch","f:floorarea:uom","f:fslandarea:uom","mapBounds"],c=m(),d=p(".save-search-modal__search-parameters__list");for(e in d.empty(),c)!c.hasOwnProperty(e)||0<=p.inArray(e,s)||(t=function(e,t){var r=e[t],n=e[t+":uom"];if(n)return r=e[t]+" "+n;n=t.replace("f:",""),n=p("#"+n+" .facet__suffix").text();if(n)return r=e[t]+" "+n;return"f:recenttransactions"!==t?r:"0"!==e[t]?r=p("#recenttransactions .coveo-facet-header-title").text():""}(c,e),"f:location"===e&&(o=t.split(">").pop()),"f:propertytype"===e?(r=(i=t).split(","),p.each(r,function(e,t){d.append("<li><span>"+t+"</span></li>")})):""!==t&&d.append("<li><span>"+t+"</span></li>"));v(a,o,i,u),f(l),p(n).modal("show")})}function m(e){var e=e?e.split("#")[1]:window.location.href.slice(window.location.href.indexOf("#")+1),t={};if(!e)return t;for(var r=e.split("&"),n=0;n<r.length;n++){var a=r[n].split("="),o=a[0],a=void 0===a[1]||a[1];a=function(e,t){if(0<=e.indexOf(":uom"))return t;e=e.replace("f:",""),e=p("#"+e+" .facet__prefix").first().text();e=e||"";t.startsWith("..")?t=t.replace(/\../g,"< "+e):t.endsWith("..")?(t=t.replace(/\./g,""),t="> "+e+t):0<=t.indexOf("..")&&(t=t.replace(/\../g," - "+e),t=e+t);return t}(o,a=(a=decodeURIComponent(a)).replace(/\[/g,"").replace(/\]/g,"")),t[o]?(t[o]&&"string"==typeof t[o]&&(t[o]=[t[o]]),t[o].push(a)):t[o]=a}return t}return{init:function(){p(document).on("click","#saveSubscriptionFrequency",function(){var e=p("#subscriptionsForm").serializeArray(),t=COLLIERS.Helix.getCSRFTokenHeader(p(this));COLLIERS.Ajax.postDataWithHeaders(t,"/subscription/save-subscription-frequency",null,function(){p("#subscriptionFrequencyError").removeAttr("hidden")},e)}),p(document).on("click",".subscribe-login",function(e){p("#createAccount").modal("show"),e.preventDefault()}),r(".modal-subscribe","properties-subscribe",0),r(".js-modal-research-subscribe","research-subscribe",1),r(".js-modal-news-subscribe","news-subscribe",1),e(".modal-news-subscribe","news-subscribe"),e(".modal-research-subscribe","research-subscribe"),p(document).on("click",".saveSearch",function(){var e,a,t,o=p(this).find("input.remove-subscription-id").val();""!==o&&(e={id:o},a="#subscriptionRemoveResponse"+o,t=COLLIERS.Helix.getCSRFTokenHeader(p(this)),COLLIERS.Ajax.postDataWithHeaders(t,"/subscription/remove-subscription",function(e){var t,r,n;p(a).attr("hidden","hidden"),p("#removeSubscription-"+o).modal("hide"),!0===e.NoSubscriptions?(p("#subscriptionsPanel").attr("hidden",!0),p("#unsubscribePanel").attr("hidden",!0),p("#noSubscriptionsPanel").removeAttr("hidden")):(r=p(t="#subscription-"+o),n=r.closest("tbody"),r.remove(),n.find("tr").length||(e=n.closest(".carousel-item"),t=e.closest(".carousel"),r=t.find(".carousel-indicators"),n=r.find(".page-item.active"),r.children("li").not(n).each(function(e,t){0===e&&p(t).find("a").click(),p(t).attr("data-slide-to",e).find("a").html(e+1)}),e.remove(),n.remove(),r.children("li").length<=1&&r.closest(".pagination").remove(),t.find(".carousel-item").length||(t.prev(".listing-intro").remove(),t.next(".no-listings-message").removeClass("d-none"),t.remove())))},function(e){p(a).removeAttr("hidden"),p(a).text(e.statusText)},e))}),p(document).on("keypress","#saveSearchName",function(){if(13==event.keyCode)return event.preventDefault(),!1})},QueryEventData:{},QueryStringArguments:{},getAllUrlParams:m}}(jQuery),(COLLIERS=COLLIERS||{}).UnsubscribeForm=function(e){var t=e(".js-unsubscribe-input"),r=e("#adviceMessage"),n=e(".js-unsubscribe-input + .error");return{init:function(){t.on("keyup",function(){r.show(),n.hide(),""==t.val()&&r.hide()})}}}(jQuery);